<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="moviewer.css">
<script src="inc/jquery-3.2.1.js"></script>
<script src="AimaraJS/Aimara.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="AimaraJS/Aimara.css">

<script src="helper.js"></script>
<script src="drawer.js"></script>
<script src="main.js"></script>

<script type="text/javascript">
	window.onload = function() {
		tree = createTree('div_tree', 'white', null);
		div_tree = document.getElementById('div_tree');
		div_main = document.getElementById('div_main');

		tree.nodeSelectedEvent = onNodeSelect
		
		tree.mouseOverNodeEvent 	= function (node, span) {hoverInToMiniview(node.xml_node,span) }
		tree.mouseLeavesNodeEvent	= function (node, span) {hoverOutOfMiniview(node.xml_node,span) }

		processXMLFile('xml/ServiceDefCOM.xml');
		processXMLFile('xml/ServiceDefCommon.xml');
		processXMLFile('xml/ServiceDefMAL.xml');
		processXMLFile('xml/ServiceDefMC.xml');

		tree.drawTree();
		div_tree.appendChild(tree_fragment)

		var urlSearch = new URLSearchParams(location.search);
		if (typeof urlSearch.get("u") != 'undefined') {
			tree.selectNodeFromPath(urlSearch.get("u"));
		}

	}
	
	$(window).on("popstate", function(e) {
		var urlSearch = new URLSearchParams(location.search);
		if (typeof urlSearch.get("u") != 'undefined') {
			console.info(urlSearch.get("u"))
			tree.selectNodeFromPath(urlSearch.get("u"));
		}

	})
</script>
</head>
<body>
	<div id="div_tree"></div>
	<div id="div_main"></div>
	<div id="notification_bar" class="notificationBar"></div>
	<div class="copyright">
		Thanks to <a href="http://www.famfamfam.com/lab/icons/silk/">Fam
			Fam Fam Silk Icons</a> for the awesome icons.<br /> Copyright:
		Jos&eacute; Lu&iacute;s F. Feiteirinha 2018
	</div>

	<div id="div_miniview" class="miniview"></div>
</body>
</html>
